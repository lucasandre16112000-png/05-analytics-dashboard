<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä {{ title }}</h1>
            <p>Gerado em {{ generated_at }}</p>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <h3>Page Views</h3>
                <div class="value">{{ metrics.total_page_views|int }}</div>
                <div class="unit">Total</div>
            </div>
            
            <div class="metric-card">
                <h3>Visitantes √önicos</h3>
                <div class="value">{{ metrics.total_unique_visitors|int }}</div>
                <div class="unit">Total</div>
            </div>
            
            <div class="metric-card">
                <h3>Taxa de Convers√£o</h3>
                <div class="value">{{ metrics.average_conversion_rate|round(2) }}%</div>
                <div class="unit">M√©dia</div>
            </div>
            
            <div class="metric-card">
                <h3>Receita</h3>
                <div class="value">R$ {{ metrics.total_revenue|round(2) }}</div>
                <div class="unit">Total</div>
            </div>
            
            <div class="metric-card">
                <h3>Taxa de Rejei√ß√£o</h3>
                <div class="value">{{ metrics.average_bounce_rate|round(2) }}%</div>
                <div class="unit">M√©dia</div>
            </div>
            
            <div class="metric-card">
                <h3>Dura√ß√£o da Sess√£o</h3>
                <div class="value">{{ metrics.average_session_duration|round(2) }}</div>
                <div class="unit">Minutos</div>
            </div>
        </div>
        
        <div class="charts-grid">
            <div class="chart-container">
                <h3>Page Views por Hora</h3>
                <div id="hourly-chart" class="chart"></div>
            </div>
            
            <div class="chart-container">
                <h3>Page Views por Dia</h3>
                <div id="daily-chart" class="chart"></div>
            </div>
            
            <div class="chart-container">
                <h3>Distribui√ß√£o por Dispositivo</h3>
                <div id="device-chart" class- "chart"></div>
            </div>
            
            <div class="chart-container">
                <h3>Distribui√ß√£o por Fonte</h3>
                <div id="source-chart" class="chart"></div>
            </div>
        </div>
        
        <div class="footer">
            <p>Dashboard gerado automaticamente ‚Ä¢ Desenvolvido por Lucas Andr√© S</p>
        </div>
    </div>
    
    <script>
        // Gr√°fico de Page Views por Hora
        var hourlyData = {{ hourly_stats.to_json()|safe }};
        var hourlyTrace = {
            x: Object.keys(hourlyData.page_views),
            y: Object.values(hourlyData.page_views),
            type: 'scatter',
            mode: 'lines+markers',
            fill: 'tozeroy',
            name: 'Page Views',
            line: {color: '#667eea'}
        };
        Plotly.newPlot('hourly-chart', [hourlyTrace], {
            title: '',
            xaxis: {title: 'Hora do Dia'},
            yaxis: {title: 'Page Views'},
            margin: {t: 20}
        });
        
        // Gr√°fico de Page Views por Dia
        var dailyData = {{ daily_stats.to_json()|safe }};
        var dailyTrace = {
            x: Object.keys(dailyData.page_views),
            y: Object.values(dailyData.page_views),
            type: 'bar',
            name: 'Page Views',
            marker: {color: '#764ba2'}
        };
        Plotly.newPlot('daily-chart', [dailyTrace], {
            title: '',
            xaxis: {title: 'Data'},
            yaxis: {title: 'Page Views'},
            margin: {t: 20}
        });
        
        // Gr√°fico de Dispositivos
        var deviceData = {{ device_stats|tojson }};
        var deviceTrace = {
            labels: Object.keys(deviceData),
            values: Object.values(deviceData).map(d => d.page_views),
            type: 'pie',
            marker: {colors: ['#667eea', '#764ba2', '#f093fb']}
        };
        Plotly.newPlot('device-chart', [deviceTrace], {
            title: '',
            margin: {t: 20}
        });
        
        // Gr√°fico de Fontes
        var sourceData = {{ source_stats|tojson }};
        var sourceTrace = {
            labels: Object.keys(sourceData),
            values: Object.values(sourceData).map(d => d.page_views),
            type: 'pie',
            marker: {colors: ['#667eea', '#764ba2', '#f093fb', '#4facfe']}
        };
        Plotly.newPlot('source-chart', [sourceTrace], {
            title: '',
            margin: {t: 20}
        });
    </script>
</body>
</html>
